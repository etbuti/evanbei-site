<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Agent Registry</title>
<meta name="robots" content="index,follow"/>

<style>
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;line-height:1.6}
.wrap{max-width:980px;margin:0 auto;padding:28px 18px 70px}
.card{border:1px solid rgba(0,0,0,.12);border-radius:16px;padding:14px 14px;background:#fff;margin-top:14px}
.k{opacity:.65}
ul{margin:8px 0 0 18px}
code,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono",monospace}
pre{overflow:auto;padding:12px;border-radius:12px;background:rgba(0,0,0,.04)}

.agent-badge{margin-top:14px;text-align:center;opacity:0.35}
.agent-badge img{transform:scale(0.7);filter:grayscale(100%)}
.agent-badge:hover{opacity:0.8}
.agent-badge:hover img{filter:grayscale(0%)}

/* ===== Node Health ===== */
.nh-title{display:flex;align-items:center;gap:10px;margin-bottom:8px}
.nh-dot{width:10px;height:10px;border-radius:999px;display:inline-block}
.nh-dot--idle{background:#999}
.nh-dot--ok{background:#22c55e}
.nh-dot--warn{background:#f59e0b}
.nh-dot--bad{background:#ef4444}

.nh-grid{display:flex;flex-wrap:wrap;gap:8px;margin-top:6px}
.nh-chip{
  display:inline-flex;align-items:center;gap:8px;
  padding:6px 10px;border-radius:999px;
  border:1px solid rgba(0,0,0,.15);
  background:rgba(0,0,0,.03);
  font-size:13px
}
.nh-pill{width:8px;height:8px;border-radius:999px;display:inline-block}
.nh-pill--ok{background:#22c55e}
.nh-pill--warn{background:#f59e0b}
.nh-pill--bad{background:#ef4444}
</style>
</head>

<body>
<div class="wrap">
  <h1>Agent Registry</h1>
  <p class="k">A human-facing directory for this node’s machine entry, capabilities, policies, and audit links.</p>

  <div class="card">
    <h3>Identity</h3>

    <!-- ===== Node Health Badge ===== -->
    <div class="nh-title">
      <span id="nh-dot" class="nh-dot nh-dot--idle"></span>
      <strong>Node Health</strong>
      <span id="nh-summary" class="k">checking…</span>
    </div>
    <div id="nh-grid" class="nh-grid"></div>
    <!-- ===== END ===== -->

    <div><strong>Entity</strong>: Evan Bei / billund</div>
    <div><strong>Canonical</strong>: <a href="https://evanbei.com/">https://evanbei.com/</a></div>
    <div><strong>Node</strong>: <a href="/node/">/node/</a></div>
  </div>

  <div class="card">
    <h3>Machine Entry</h3>
    <div><strong>node.json</strong>: <a href="/.well-known/node.json">/.well-known/node.json</a></div>
    <div class="k" style="margin-top:6px">Stable machine entry for agents and indexers.</div>
  </div>

  <div class="card">
    <h3>Agent Resources</h3>
    <ul class="k">
      <li>Manifest: <a href="/agent/manifest.json">/agent/manifest.json</a></li>
      <li>Protocol: <a href="/agent/protocol.json">/agent/protocol.json</a></li>
      <li>Access Policy: <a href="/agent/access-policy.json">/agent/access-policy.json</a></li>
      <li>Capability Map: <a href="/agent/capability-map.json">/agent/capability-map.json</a></li>
      <li>Trace Template: <a href="/agent/trace-template.json">/agent/trace-template.json</a></li>
      <li>Trace Builder: <a href="/agent/trace.html">/agent/trace.html</a></li>
      <li>Wallet Sign: <a href="/agent/sign.html">/agent/sign.html</a></li>
      <li>Invite Check: <a href="/agent/invite-check.html">/agent/invite-check.html</a></li>
      <li>Invite Keys (hashed): <a href="/agent/invite-keys.json">/agent/invite-keys.json</a></li>
    </ul>
  </div>

  <div class="card">
    <h3>Policy & Principles</h3>
    <div><strong>Principles</strong>: <a href="https://gate.evanbei.com/principles.html">https://gate.evanbei.com/principles.html</a></div>
    <div class="k" style="margin-top:6px">Agents should acknowledge principles before invoking executable capabilities.</div>
  </div>

  <div class="card">
    <h3>Audit</h3>
    <ul class="k">
      <li>Health check: <a href="/node/health.html">/node/health.html</a></li>
      <li>Checksums: <a href="/node/checksums.json">/node/checksums.json</a></li>
    </ul>
  </div>

  <div class="card">
    <h3>Registry Index (machine)</h3>
    <div><strong>registry.json</strong>: <a href="/agent/registry.json">/agent/registry.json</a></div>
    <div class="k" style="margin-top:6px">A compact index for crawlers and agent directories.</div>
  </div>

  <div class="card agent-badge">
    <div class="k">Listed on AI Agents Directory</div>
    <a href="https://aiagentsdirectory.com?utm_source=badge&utm_medium=referral&utm_campaign=free_listing&utm_content=homepage"
       target="_blank" rel="noopener noreferrer">
      <img src="https://aiagentsdirectory.com/featured-badge.svg?v=2024"
           alt="Featured AI Agents on AI Agents Directory"
           width="200" height="50"/>
    </a>
  </div>

  <div class="card">
    <h3>Discovery</h3>
    <ol class="k">
      <li>Fetch <a href="https://evanbei.com/.well-known/node.json">https://evanbei.com/.well-known/node.json</a></li>
      <li>Read declared capabilities and access classes</li>
      <li>Use public endpoints directly</li>
      <li>For invite-gated capabilities, verify via <a href="/agent/invite-check.html">/agent/invite-check.html</a></li>
      <li>Express invocation using the provided trace template</li>
    </ol>
  </div>
</div>

<script>
const checks=[
{n:"node.json",u:"/.well-known/node.json",c:true},
{n:"portal.json",u:"/portal/portal.json",c:true},
{n:"manifest",u:"/agent/manifest.json",c:true},
{n:"protocol",u:"/agent/protocol.json",c:true},
{n:"access",u:"/agent/access-policy.json",c:true},
{n:"cap-map",u:"/agent/capability-map.json",c:true}
];

async function runHealth(){
const grid=document.getElementById("nh-grid");
const dot=document.getElementById("nh-dot");
const sum=document.getElementById("nh-summary");
grid.innerHTML="";
let bad=0;

for(const c of checks){
try{
const r=await fetch(c.u+"?_="+Date.now());
const ok=r.ok && !!JSON.parse(await r.text());
const div=document.createElement("div");
div.className="nh-chip";
div.innerHTML='<span class="nh-pill nh-pill--'+(ok?"ok":"bad")+'"></span><a href="'+c.u+'" target="_blank">'+c.n+'</a>';
if(!ok && c.c) bad++;
grid.appendChild(div);
}catch(e){
bad++;
}
}

dot.className="nh-dot "+(bad?"nh-dot--bad":"nh-dot--ok");
sum.textContent=bad?"critical failed":"all green";
}

runHealth();
setInterval(runHealth,60000);
</script>

</body>
</html>
