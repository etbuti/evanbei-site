<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Spatial Passport Registry</title>

<style>
body{
  font-family:Arial, sans-serif;
  background:#fff;
  color:#111;
  max-width:760px;
  margin:80px auto;
}

.item{
  display:flex;
  align-items:center;
  margin:14px 0;
}

.item img{
  width:60px;
  height:60px;
  object-fit:cover;
  margin-right:16px;
  opacity:.85;
}

a{
  text-decoration:none;
  color:#000;
}

.small{
  opacity:.5;
  margin-bottom:30px;
}
</style>
</head>

<body>

<h3>Spatial Passport</h3>
<p class="small">Registry · Auto Preview</p>

<div id="list"></div>

<script>
fetch('./')
.then(r=>r.text())
.then(html=>{

  const div=document.createElement('div');
  div.innerHTML=html;

  const links=[...div.querySelectorAll('a')];

  const list=document.getElementById('list');

  const items=[];   // ⭐ 新增：先收集，再排序

  links.forEach(a=>{

    const href=a.getAttribute('href');

    if(!href) return;
    if(!href.endsWith('.html')) return;
    if(href.startsWith('_')) return;
    if(href==='index.html') return;
    if(href==='generator.html') return;

    fetch(href)
    .then(r=>r.text())
    .then(page=>{

      const m=page.match(/<img src="([^"]+)"/);
      if(!m) return;

      const img=m[1];

      // ⭐ 关键：从文件名提取编号
      const numMatch=href.match(/(\d+)/);
      const order=numMatch ? parseInt(numMatch[1]) : 9999;

      items.push({href,img,order});

      render();

    });

  });

  function render(){

    // ⭐ 按编号排序
    items.sort((a,b)=>a.order-b.order);

    list.innerHTML='';

    items.forEach(it=>{

      const wrap=document.createElement('div');
      wrap.className="item";

      const image=document.createElement('img');
      image.src=it.img;

      const link=document.createElement('a');
      link.href=it.href;
      link.textContent=it.href.replace('.html','');

      wrap.appendChild(image);
      wrap.appendChild(link);

      list.appendChild(wrap);

    });

  }

});
</script>


</body>
</html>
